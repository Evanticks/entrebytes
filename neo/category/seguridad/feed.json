{
    "version": "https://jsonfeed.org/version/1",
    "title": "Hexo • All posts by \"seguridad\" category",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2023/01/26/vpn-wireguard/",
            "url": "http://example.com/2023/01/26/vpn-wireguard/",
            "title": "VPN Wireguard",
            "date_published": "2023-01-26T18:57:47.828Z",
            "content_html": "<p><img src=\"/images/logo-wireguard.png\" alt=\"wireguard-site-1.png\"></p>\n<h1 id=\"site-to-site\"><a class=\"markdownIt-Anchor\" href=\"#site-to-site\">#</a> Site to Site</h1>\n<h2 id=\"linux\"><a class=\"markdownIt-Anchor\" href=\"#linux\">#</a> Linux</h2>\n<p>Primero vamos a cada cliente y vamos a establecer la ruta por defecto</p>\n<pre><code>Cliente 1:\n    sudo ip route del default\n    sudo ip route add default via 192.168.200.1\n</code></pre>\n<pre><code>Cliente 2:\n\n    sudo ip route del default\n    sudo ip route add default via 192.168.100.1\n</code></pre>\n<p>Ahora nos conectarems a <strong>cada servidor</strong> de manera que en cada uno realizaremos los siguientes comandos:</p>\n<pre><code>Instalamos wireguard\n    sudo apt update\n    sudo apt install wireguard\n</code></pre>\n<p>Creamos la clave privada y pública</p>\n<p><code>wg genkey | sudo tee /etc/wireguard/server_private.key | wg pubkey | sudo tee /etc/wireguard/server_public.key</code></p>\n<pre><code>cat /etc/wireguard/server_private.key\ncat /etc/wireguard/server_public.key\n</code></pre>\n<p>El resultado de los comandos será cada clave pública y privada de los servidores</p>\n<p>Creo el fichero de configuración en el que la interfaz se llamará wg0.conf</p>\n<pre><code>sudo nano /etc/wireguard/wg0.conf\n</code></pre>\n<p>Después de esto en vpn1 quedará el archivo de configuración de la siguiente manera:</p>\n<pre><code>[Interface]\nAddress = 10.99.99.1\nPrivateKey = UKn7oartqeJjRPk8jUtACSTYn/e23wszOBxT/Ymo1Uk=\nListenPort = 51820\n\n[Peer]\nPublicKey = PWrfuUd1UODnjTPuFCJfy/eixRTEsCq/KioI74/vDFo=\nAllowedIPs = 0.0.0.0/0\nEndpoint = 10.0.0.1:51820\nPersistentKeepAlive = 25\n\n</code></pre>\n<p>El siguiente archivo de configuración es el de vpn2:</p>\n<pre><code>[Interface]\nAddress = 10.99.99.2\nPrivateKey = MCL13K+q/43eyF8qLtBxz9cNhvcFxQ2s98LOiseZy3w=\nListenPort = 51820\n\n[Peer]\nPublicKey = 2az5T5rW/7x1Z/YLRfX7saNteaOsoupFh07Z6VkeUjI=\nAllowedIPs = 0.0.0.0/0\nEndpoint = 10.0.0.10:51820\n</code></pre>\n<p>Ahora en <strong>cada servidor</strong> emplearemos</p>\n<p><code>wg-quick up wg0</code>  para activar el servicio<br>\n <code>wg-quick down wg0</code>  para desactivar el servicio<br>\n <code>wg</code>  para poder ver el estado del servicio</p>\n<p>En los servidores hay que intercambiar las respectivas claves públicas e ingresarlo en PublicKey.<br>\nAddress es la ip del túnel que se va a asignar en cada extremo del servidor.<br>\nAllowedIPs es las ip permitidas hacia el servidor<br>\nEndpoint es la ip pública del servidor y el puerto que se ha configurado en el servidor opuesto.<br>\nPersistentKeepAlive es el tiempo en el que se realizan las comprobaciones de conexión.</p>\n<p>Ahora entraremos a cada cliente y realizaremos la comprobación de que pueden conectarse:</p>\n<p><img src=\"/images/wireguard-site-1.png\" alt=\"wireguard-site-1.png\"></p>\n<h2 id=\"cliente-windows\"><a class=\"markdownIt-Anchor\" href=\"#cliente-windows\">#</a> Cliente Windows</h2>\n<p>Ahora vamos a proceder a conectar un segundo cliente windows:</p>\n<p><img src=\"/images/wireguard-site-2.png\" alt=\"wireguard-site-2.png\"></p>\n<p>Ahora cambiaremos la interfaz para establecer una ip estática:</p>\n<p><img src=\"/images/wireguard-site-3.png\" alt=\"wireguard-site-2.png\"></p>\n<p>Una vez hecho esto probamos a hacer un ping para ver que podemos comunicarnos en remoto a través de la VPN</p>\n<p><img src=\"/images/wireguard-site-4.png\" alt=\"wireguard-site-2.png\"></p>\n<h1 id=\"point-to-site\"><a class=\"markdownIt-Anchor\" href=\"#point-to-site\">#</a> Point to Site</h1>\n<p>La misma configuración que en el site to site, solo que no activaremos el bit de forwarding en el cliente final ya que este mismo no hará de router.</p>\n<pre><code>[Interface]\nAddress = 10.99.99.1\nPrivateKey = 4GLQzZT6G/Oq69aAitajxl7ZRtzuV1cFrsI0j4Cqjk4=\nListenPort = 51820\n\n[Peer]\nPublickey = fKWBm53DKrAAukk6nssSZ0DuVy9jEBIRKbqOS22sdg8=\nAllowedIPs = 0.0.0.0/0\nPersistentKeepAlive = 25\nEndpoint = 192.188.188.20:51820\n\n</code></pre>\n<p><img src=\"/images/vpn-cliente-C-lin.png\" alt=\"wireguard-site-1.png\"></p>\n<p>Luego conectaremos la interfaz en windows como explicamos anteriormente y activaremos la configuración de la VPN como hemos hecho en linux, solo que esta vez su ip de la ruta será<br>\n10.99.99.4/32</p>\n<p><img src=\"/images/vpn-cliente-C-win2.png\" alt=\"wireguard-site-1.png\"></p>\n<p>Finalmente copiamos la configuración en el servidor con la clave pública de la vpn de windows y de esta manera reiniciando el servicio con wg-quick down wg0 y wg-quick up wg0 ya tendremos la vpn funcionando.</p>\n<pre><code>[Peer]\nPublickey = I/Gj50Ue+qmv+a4Q+C1VcJ4VptBVnU3QfDgo//vq+Fw=\nAllowedIPs = 0.0.0.0/0\nPersistentKeepAlive = 25\nEndpoint = 192.188.188.21:51820\n</code></pre>\n<p><img src=\"/images/vpn-cliente-C-win.png\" alt=\"wireguard-site-1.png\"></p>\n",
            "tags": [
                "Seguridad"
            ]
        },
        {
            "id": "http://example.com/2023/01/24/vpn/",
            "url": "http://example.com/2023/01/24/vpn/",
            "title": "Cliente-Servidor Openvpn",
            "date_published": "2023-01-24T10:06:01.371Z",
            "content_html": "<p><img src=\"/images/vpn-logo.png\" alt=\"Descripción de la imagen\"></p>\n<h1 id=\"cliente-servidor-openvpn\"><a class=\"markdownIt-Anchor\" href=\"#cliente-servidor-openvpn\">#</a> Cliente-Servidor Openvpn</h1>\n<h2 id=\"servidor\"><a class=\"markdownIt-Anchor\" href=\"#servidor\">#</a> Servidor</h2>\n<p>Tendremos un escenario en vagrant en el cual constará de 3 máquinas, un cliente externo, el servidor vpn</p>\n<p>Entramos en el servidor vpn y haremos apt update, y después instalaremos openvpn que servirá tanto para el cliente como para el servidor.</p>\n<p>Activamos el bit de forwarding en  <code>/etc/sysctl.conf</code>   net.ipv4.ip_forward=1<br>\nEjecutamos  <code>sudo sysctl -p</code>  para que lea el archivo sysctl.conf</p>\n<p>sudo cp -r /usr/share/easy-rsa /etc/openvpn</p>\n<p>cd /etc/openvpn/easy-rsa</p>\n<p>Activamos el servicio de infraestructura pública:</p>\n<p>sudo ./easyrsa init-pki</p>\n<p>Tras esto generamos la entidad certificadora con su respectiva clave privada gracias al binario easyrsa.</p>\n<p>./easyrsa build-ca</p>\n<p>Ahora vamos a montar el servidor de certificaciones:</p>\n<p>./easyrsa build-server-full server nopass</p>\n<p>Generamos parámetros de Diffie-Helman, el objetivo del algoritmo de cifrado Diffie-Hellman es lograr el intercambio de una clave secreta por medio de un canal inseguro como es internet. Para que este algoritmo funcione, los datos informáticos deben traducirse a números, lo cual es posible por medio de sistemas como el código ASCII, combinado con otros.</p>\n<p><code>sudo ./easyrsa gen-dh</code></p>\n<p>Generamos el par de claves del cliente:<br>\n./easyrsa build-client-full clientevpn nopass</p>\n<p>Ahora pasamos las claves al servidor cliente<br>\nsudo cp -rp /etc/openvpn/easy-rsa/pki/{ca.crt,issued/clientevpn.crt,private/clientevpn.key} /home/vagrant/<br>\ncd /home/vagrant<br>\nsudo chown vagrant:vagrant {ca.crt,clientevpn.crt,clientevpn.key}<br>\nscp {ca.crt,clientevpn.crt,clientevpn.key} vagrant@vpn-cli:</p>\n<p>Ahora configuraremos los parámetros del servidor y sus saltos:</p>\n<p><code>/etc/openvpn/server/servidor.conf</code></p>\n<figure class=\"highlight ruby\"><figcaption data-lang=\"ruby\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>port <span class=\"token number\">1194</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>proto udp</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>dev tun</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ca <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span>ca<span class=\"token punctuation\">.</span>crt</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>cert <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span>issued<span class=\"token operator\">/</span>server<span class=\"token punctuation\">.</span>crt</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>key <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span><span class=\"token keyword\">private</span><span class=\"token operator\">/</span>server<span class=\"token punctuation\">.</span>key</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>dh <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span>dh<span class=\"token punctuation\">.</span>pem</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>topology subnet</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>server <span class=\"token number\">9.8</span><span class=\"token number\">.7</span><span class=\"token number\">.0</span> <span class=\"token number\">255.255</span><span class=\"token number\">.255</span><span class=\"token number\">.0</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>ifconfig<span class=\"token operator\">-</span>pool<span class=\"token operator\">-</span>persist <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>log<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>ipp<span class=\"token punctuation\">.</span>txt</pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>push <span class=\"token string-literal\"><span class=\"token string\">\"route 192.168.0.0 255.255.255.0\"</span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>keepalive <span class=\"token number\">10</span> <span class=\"token number\">120</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>cipher <span class=\"token constant\">AES</span><span class=\"token operator\">-</span><span class=\"token number\">256</span><span class=\"token operator\">-</span><span class=\"token constant\">CBC</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>persist<span class=\"token operator\">-</span>key</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>persist<span class=\"token operator\">-</span>tun</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>status <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>log<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">-</span>status<span class=\"token punctuation\">.</span>log</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>verb <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>explicit<span class=\"token operator\">-</span>exit<span class=\"token operator\">-</span>notify <span class=\"token number\">1</span></pre></td></tr></table></figure><p>sudo systemctl enable --now openvpn-server@servidor</p>\n<h2 id=\"cliente\"><a class=\"markdownIt-Anchor\" href=\"#cliente\">#</a> Cliente</h2>\n<p>sudo apt update<br>\nsudo apt install openvpn</p>\n<p>sudo mv {ca.crt,clientevpn.crt,clientevpn.key} /etc/openvpn/client<br>\nsudo chown root: /etc/openvpn/client/*</p>\n<p>Ahora vamos a crear el fichero /etc/openvpn/client/cliente.conf</p>\n<figure class=\"highlight ruby\"><figcaption data-lang=\"ruby\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>client</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>dev tun</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>proto udp</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>remote <span class=\"token number\">192.22</span><span class=\"token number\">.23</span><span class=\"token number\">.1</span> <span class=\"token number\">1194</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>resolv<span class=\"token operator\">-</span><span class=\"token keyword\">retry</span> infinite</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>nobind</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>persist<span class=\"token operator\">-</span>key</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>persist<span class=\"token operator\">-</span>tun</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>ca <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>client<span class=\"token operator\">/</span>ca<span class=\"token punctuation\">.</span>crt</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>cert <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>client<span class=\"token operator\">/</span>clientevpn<span class=\"token punctuation\">.</span>crt</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>key <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>client<span class=\"token operator\">/</span>clientevpn<span class=\"token punctuation\">.</span>key</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>remote<span class=\"token operator\">-</span>cert<span class=\"token operator\">-</span>tls server</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>cipher <span class=\"token constant\">AES</span><span class=\"token operator\">-</span><span class=\"token number\">256</span><span class=\"token operator\">-</span><span class=\"token constant\">CBC</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>verb <span class=\"token number\">3</span></pre></td></tr></table></figure><p>E iniciamos la el servicio de la configuración:</p>\n<p>sudo systemctl enable --now openvpn-client@cliente</p>\n<h2 id=\"máquina-interna\"><a class=\"markdownIt-Anchor\" href=\"#máquina-interna\">#</a> Máquina interna</h2>\n<p>Quitamos la ip de la ruta por defecto que viene en vagrant:</p>\n<p>sudo ip route del default</p>\n<p>Añadimos la ruta que creamos hacia la vpn:</p>\n<p>sudo ip route add default via 192.168.0.1</p>\n<p>comprobaciones</p>\n<p><img src=\"/images/vpn-acceso-remoto-ssh-openvpn.png\" alt=\"Descripción de la imagen\"></p>\n<p><img src=\"/images/traceroute-openvpn.png\" alt=\"Descripción de la imagen\"></p>\n<h1 id=\"site-to-site-openvpn\"><a class=\"markdownIt-Anchor\" href=\"#site-to-site-openvpn\">#</a> Site-To-Site Openvpn</h1>\n<p><img src=\"/images/vpn-site-esquema.png\" alt=\"Descripción de la imagen\"></p>\n<h2 id=\"servidor-2\"><a class=\"markdownIt-Anchor\" href=\"#servidor-2\">#</a> Servidor</h2>\n<p>Entramos en el servidor vpn y haremos apt update, y después instalaremos openvpn que servirá tanto para el cliente como para el servidor.</p>\n<p>Activamos el bit de forwarding en  <code>/etc/sysctl.conf</code>   net.ipv4.ip_forward=1<br>\nEjecutamos  <code>sudo sysctl -p</code>  para que lea el archivo sysctl.conf</p>\n<p><code>sudo cp -r /usr/share/easy-rsa /etc/openvpn</code></p>\n<p><code>cd /etc/openvpn/easy-rsa</code></p>\n<p>Activamos el servicio de infraestructura pública:</p>\n<p><code>sudo ./easyrsa init-pki</code> <br>\nTras esto generamos la entidad certificadora con su respectiva clave privada gracias al binario easyrsa.</p>\n<p><code>./easyrsa build-ca</code> <br>\nAhora vamos a montar el servidor de certificaciones:</p>\n<p><code>./easyrsa build-server-full server nopass</code></p>\n<p><code>sudo ./easyrsa gen-dh</code></p>\n<p>Generamos el par de claves del cliente:<br>\n <code>./easyrsa build-client-full clientevpn nopass</code></p>\n<p>Ahora pasamos las claves al servidor cliente</p>\n<figure class=\"highlight ruby\"><figcaption data-lang=\"ruby\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sudo cp <span class=\"token operator\">-</span>rp <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span><span class=\"token punctuation\">&#123;</span>ca<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">,</span>issued<span class=\"token operator\">/</span>clientevpn<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">,</span><span class=\"token keyword\">private</span><span class=\"token operator\">/</span>clientevpn<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">/</span>home<span class=\"token regex-literal\"><span class=\"token regex\">/vagrant/</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>cd <span class=\"token operator\">/</span>home<span class=\"token operator\">/</span>vagrant</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sudo chown vagrant<span class=\"token symbol\">:vagrant</span> <span class=\"token punctuation\">&#123;</span>ca<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">,</span>clientevpn<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">,</span>clientevpn<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>scp <span class=\"token punctuation\">&#123;</span>ca<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">,</span>clientevpn<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">,</span>clientevpn<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">&#125;</span> vagrant<span class=\"token variable\">@vpn</span><span class=\"token operator\">-</span>cli<span class=\"token operator\">:</span></pre></td></tr></table></figure><p>A partir de aquí la configuración varía respecto a la parte de cliente-servidor:</p>\n<figure class=\"highlight ruby\"><figcaption data-lang=\"ruby\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dev tun</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ifconfig <span class=\"token number\">10.99</span><span class=\"token number\">.99</span><span class=\"token number\">.1</span> <span class=\"token number\">10.99</span><span class=\"token number\">.99</span><span class=\"token number\">.2</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>route <span class=\"token number\">192.168</span><span class=\"token number\">.100</span><span class=\"token number\">.0</span> <span class=\"token number\">255.255</span><span class=\"token number\">.255</span><span class=\"token number\">.0</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>tls<span class=\"token operator\">-</span>server</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>dh <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span>dh<span class=\"token punctuation\">.</span>pem</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ca <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span>ca<span class=\"token punctuation\">.</span>crt</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>cert <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span>issued<span class=\"token operator\">/</span>server<span class=\"token punctuation\">.</span>crt</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>key <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>easy<span class=\"token operator\">-</span>rsa<span class=\"token operator\">/</span>pki<span class=\"token operator\">/</span><span class=\"token keyword\">private</span><span class=\"token operator\">/</span>server<span class=\"token punctuation\">.</span>key</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>comp<span class=\"token operator\">-</span>lzo</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>keepalive <span class=\"token number\">10</span> <span class=\"token number\">60</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>verb <span class=\"token number\">3</span></pre></td></tr></table></figure><p><code>sudo systemctl enable --now openvpn-server@servidor</code></p>\n<h2 id=\"cliente-2\"><a class=\"markdownIt-Anchor\" href=\"#cliente-2\">#</a> Cliente</h2>\n<figure class=\"highlight ruby\"><figcaption data-lang=\"ruby\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sudo apt update</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>sudo apt install openvpn</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>sudo mv <span class=\"token punctuation\">&#123;</span>ca<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">,</span>clientevpn<span class=\"token punctuation\">.</span>crt<span class=\"token punctuation\">,</span>clientevpn<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>client</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>sudo chown root<span class=\"token operator\">:</span> <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>client<span class=\"token operator\">/</span><span class=\"token operator\">*</span></pre></td></tr></table></figure><p>Ahora vamos a crear el fichero /etc/openvpn/client/cliente.conf</p>\n<figure class=\"highlight ruby\"><figcaption data-lang=\"ruby\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>dev tun</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>remote <span class=\"token number\">10.0</span><span class=\"token number\">.0</span><span class=\"token number\">.1</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ifconfig <span class=\"token number\">10.99</span><span class=\"token number\">.99</span><span class=\"token number\">.2</span> <span class=\"token number\">10.99</span><span class=\"token number\">.99</span><span class=\"token number\">.1</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>route <span class=\"token number\">192.168</span><span class=\"token number\">.200</span><span class=\"token number\">.0</span> <span class=\"token number\">255.255</span><span class=\"token number\">.255</span><span class=\"token number\">.0</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>tls<span class=\"token operator\">-</span>client</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>ca <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>client<span class=\"token operator\">/</span>ca<span class=\"token punctuation\">.</span>crt</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>cert <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>client<span class=\"token operator\">/</span>clientevpn<span class=\"token punctuation\">.</span>crt</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>key <span class=\"token operator\">/</span>etc<span class=\"token operator\">/</span>openvpn<span class=\"token operator\">/</span>client<span class=\"token operator\">/</span>clientevpn<span class=\"token punctuation\">.</span>key</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>comp<span class=\"token operator\">-</span>lzo</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>keepalive <span class=\"token number\">10</span> <span class=\"token number\">60</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>verb <span class=\"token number\">3</span></pre></td></tr></table></figure><p>sudo systemctl enable --now openvpn-client@cliente</p>\n<h2 id=\"cliente-1\"><a class=\"markdownIt-Anchor\" href=\"#cliente-1\">#</a> Cliente 1</h2>\n<p>sudo ip route del default<br>\nsudo ip route add default via 192.168.200.1</p>\n<p><img src=\"/images/vpn-cliente2-traceroute.png\" alt=\"Descripción de la imagen\"><br>\n<img src=\"/images/vpn-cliente1.png\" alt=\"Descripción de la imagen\"></p>\n<h2 id=\"cliente-2\"><a class=\"markdownIt-Anchor\" href=\"#cliente-2\">#</a> Cliente 2</h2>\n<p>sudo ip route del default<br>\nsudo ip route add default via 192.168.100.1</p>\n<p><img src=\"/images/vpn-cliente2-traceroute.png\" alt=\"Descripción de la imagen\"><br>\n<img src=\"/images/vpn-cliente2.png\" alt=\"Descripción de la imagen\"></p>\n",
            "tags": [
                "Seguridad"
            ]
        }
    ]
}